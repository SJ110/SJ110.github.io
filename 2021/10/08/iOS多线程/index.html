<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

<style>
    .pace .pace-progress {
        background: #1E92FB; /*��������ɫ*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*��Ӱ��ɫ*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*�ϱ߿���ɫ*/
        border-left-color: #1E92FB;    /*��߿���ɫ*/
    }
</style>
  <meta name="description" content="前言&amp;ensp;&amp;ensp; 本文参考自《iOS开发项目化经典教程》第一章,主要讲述iOS实现多线程的四种方式，线程间的安全和通信，GCD的基本操作。NSOperation的基本操作。 &amp;ensp;&amp;ensp; 多线程概念：由于一个线程同一时间内只能处理一个任务，因此一个线程内的任务需要按顺序执行。因此在遇到网络请求，下载等耗时操作时，需要等待此类操作结束才能进行接下来的操作，这段时间内用户不能进">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS多线程">
<meta property="og:url" content="http://yoursite.com/2021/10/08/iOS多线程/index.html">
<meta property="og:site_name" content="xiaopingpp">
<meta property="og:description" content="前言&amp;ensp;&amp;ensp; 本文参考自《iOS开发项目化经典教程》第一章,主要讲述iOS实现多线程的四种方式，线程间的安全和通信，GCD的基本操作。NSOperation的基本操作。 &amp;ensp;&amp;ensp; 多线程概念：由于一个线程同一时间内只能处理一个任务，因此一个线程内的任务需要按顺序执行。因此在遇到网络请求，下载等耗时操作时，需要等待此类操作结束才能进行接下来的操作，这段时间内用户不能进">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/threads.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/thread_state.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/saletickets.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/thread_state2.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/serialSerial.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/concerrentSerial.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/asyncConcerrent.png">
<meta property="og:image" content="http://yoursite.com/2021/10/08/iOS多线程/outcome.png">
<meta property="og:updated_time" content="2021-12-21T09:52:19.254Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS多线程">
<meta name="twitter:description" content="前言&amp;ensp;&amp;ensp; 本文参考自《iOS开发项目化经典教程》第一章,主要讲述iOS实现多线程的四种方式，线程间的安全和通信，GCD的基本操作。NSOperation的基本操作。 &amp;ensp;&amp;ensp; 多线程概念：由于一个线程同一时间内只能处理一个任务，因此一个线程内的任务需要按顺序执行。因此在遇到网络请求，下载等耗时操作时，需要等待此类操作结束才能进行接下来的操作，这段时间内用户不能进">
<meta name="twitter:image" content="http://yoursite.com/2021/10/08/iOS多线程/threads.png">



  <link rel="alternate" href="/atom.xml" title="xiaopingpp" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://yoursite.com/2021/10/08/iOS多线程/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>iOS多线程 | xiaopingpp</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">xiaopingpp</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/10/08/iOS多线程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiaopingpp">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xiaopingpp">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">iOS多线程

              
            
          </h1>
        

        <div class="post-meta">

          
            <i class="fa fa-thumb-tack"></i>
            <font color="7D26CD">top</font>
            <span class="post-meta-divider">|</span>
          

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-10-08 15:03:49" itemprop="dateCreated datePublished" datetime="2021-10-08T15:03:49+08:00">2021-10-08</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-12-21 17:52:19" itemprop="dateModified" datetime="2021-12-21T17:52:19+08:00">2021-12-21</time>
              </span>
            
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          <br>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span title="本文字数">9.5k</span>
            </span>
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              
              <span title="阅读时长">9 分钟</span>
            </span>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
      
      

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>&ensp;&ensp; 本文参考自<a href="https://weread.qq.com/web/reader/2ce3297071e2a5172ce5d66ke4d32d5015e4da3b7fbb1fa" target="_blank" rel="noopener">《iOS开发项目化经典教程》</a>第一章,主要讲述iOS实现多线程的四种方式，线程间的安全和通信，GCD的基本操作。NSOperation的基本操作。</p>
<p>&ensp;&ensp; 多线程概念：由于一个线程同一时间内只能处理一个任务，因此一个线程内的任务需要按顺序执行。因此在遇到网络请求，下载等耗时操作时，需要等待此类操作结束才能进行接下来的操作，这段时间内用户不能进行任何操作，app也不会响应用户的操作。这是一种很糟糕的用户体验。因此在开发过程中，通常把比较耗时的操作放到一个线程中，把和用户交互放到主线程中。保证能够及时响应用户的操作行为。</p>
<a id="more"></a>

<h3 id="进程和线程"><a href="#进程和线程" class="headerlink" title="进程和线程"></a>进程和线程</h3><p>&ensp;&ensp; 进程:进程是系统中正在运行的程序，进程拥有自己的地址空间，程序加载进内存开始运行时就会变为一个进程。进程是系统进行资源分配和调度的基本单位。有三个特点:1、独立性，进程有独立的资源和地址访问空间。2、动态性，进程是程序在系统中的一次执行过程，进程时一个正在系统中活动的指令的集合，其中加入了时间的概念。具有自己的生命周期和各自不同的状态。3、并发性,进程可以在单个处理器中并发执行，虽然宏观上是并发的，但是从微观上看，cpu在一个时间片内只能执行一条指令，因此在宏观时间内也是各个进程不断相互切换执行。<br>&ensp;&ensp; 线程:线程是任务调度和执行的基本单位，线程扩展了进程的概念，一个进程要运行至少需要一个线程，这个线程成为称为主线程。当进程被初始化后，线程就被创建了。进程内的每个线程是相互独立的。<br>&ensp;&ensp;进程中包含若干线程，这些线程可以利用进程所拥有的资源。由于线程比进程更加轻量，对线程的调用开销就会比进程的开销小的多。因此多线程更能提高系统中多个程序间的并发程度。当使用多线程进行开发时需要注意:1、线程虽然占用资源较低，但是也需要一定的内存空间，如果开启大量线程，就会占用大量内存空间导致程序卡顿。3、开启的线程越多，cpu在进行调度时的开销就越大。因此不要同时开启超过5个线程。3、使用多线程时需要保证数据的统一性。可以采用加锁的方式实现数据的独占访问。</p>
<h4 id="线程的串行和并行"><a href="#线程的串行和并行" class="headerlink" title="线程的串行和并行"></a>线程的串行和并行</h4><p>&ensp;&ensp;一个进程中如果只包含一个线程，那么当多个任务需要执行时只能由这个线程去一个一个串行执行。如果进程中包含不止一条线程，那每条线程可以同时执行不同的任务，称之为线程的并行，也即多线程。需要注意的是，cpu在同一个时间内只能处理一个线程，也就是同一时间只有一个线程在工作，不过cpu切换很快，用户感知不到。</p>
<h4 id="多线程分类"><a href="#多线程分类" class="headerlink" title="多线程分类"></a>多线程分类</h4><p>&ensp;&ensp; iOS提供了四种现实多线程的方式，pthread:使用c语言实现，是跨平台的多线程api。NSThread:使用oc实现。GCD:使用c实现，对线程管理进行了封装，是常用的多线程开发手段。NSOperation:基于GCD进行了二次封装，使其使用更加面向对象。</p>
<p><img src="/2021/10/08/iOS多线程/threads.png" alt="threads"></p>
<h4 id="线程的状态"><a href="#线程的状态" class="headerlink" title="线程的状态"></a>线程的状态</h4><p>&ensp;&ensp;当线程被创建并启动时，线程并不是直接开始执行，而线程开始执行之后也不是一直在执行。而是随着cpu的时间片轮转不停的切换状态。下图是线程的状态切换过程图。</p>
<p><img src="/2021/10/08/iOS多线程/thread_state.png" alt="thread_state"></p>
<p>1、创建，当创建一个线程之后，该线程就处于新建的状态，仅由系统分配了内存，初始化了其内部成员变量的值。2、就绪，当线程调用了start方法之后，线程就处于就绪态了，处于就绪态的线程并没有开始执行，只是表示可以开始执行了。何时开始执行由系统控制。 3、运行，当cpu分配的时间片调用当前线程时，其他线程处于挂起状态，该线程处于运行状态。4、终止，当线程执行结束，或者调用exit方式终止，或者执行过程中出现异常，线程变为终止状态。5、阻塞，如果当前线程需要暂停一段时间，则可以调用sleep方法让线程进入阻塞态。</p>
<h4 id="线程间的安全隐患"><a href="#线程间的安全隐患" class="headerlink" title="线程间的安全隐患"></a>线程间的安全隐患</h4><p>&ensp;&ensp;如果进程中的一块资源被多个线程共享，那么这块资源称为临界资源，当多个线程同时访问一块资源时，会出现资源的抢占和数据错乱等问题。为了实现数据的安全访问，可以使用线程间加锁的方式，下面通过一个卖票的例子展示一下：</p>
<p><img src="/2021/10/08/iOS多线程/saletickets.png" alt="saletickets"></p>
<p>&ensp;&ensp;从途中可以看到,多个线程访问临界资源时会发生数据错乱,为了解决这种问题,需要给临界资源加锁,加锁可以保证同一时刻只有一个线程能够访问临界资源,使用@synchronized关键字可以实现加锁.需要注意的是使用同步锁会消耗大量cpu资源,所以应该把同步锁内的代码量尽量减少.<br><img src="/2021/10/08/iOS多线程/thread_state2.png" alt="thread_state2"></p>
<h4 id="线程间通信"><a href="#线程间通信" class="headerlink" title="线程间通信"></a>线程间通信</h4><p>&ensp;&ensp;在一个进程中,其线程往往不是孤立存在的,他们之间可以相互通信,比如一个线程需要等到另外一个线程任务执行完毕后才能开始执行.在做任务转换的同时也可能有数据的转换.</p>
<h3 id="使用NSThread实现多线程"><a href="#使用NSThread实现多线程" class="headerlink" title="使用NSThread实现多线程"></a>使用NSThread实现多线程</h3><p>&ensp;&ensp;下面通过一个实例来演示NSThread的三种创建方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/// 需要调用start启动线程</span><br><span class="line">- (instancetype)initWithTarget:(id)target selector:(SEL)selector object:(nullable id)argument;</span><br><span class="line"></span><br><span class="line">+ (void)detachNewThreadSelector:(SEL)selector toTarget:(id)target withObject:(nullable id)argument;</span><br><span class="line"></span><br><span class="line">- (void)performSelectorInBackground:(SEL)aSelector withObject:(nullable id)arg;</span><br></pre></td></tr></table></figure>

<p>三种不同的线程创建方式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    _btn = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">    [_btn setTitle:@&quot;创建线程&quot; forState:UIControlStateNormal];</span><br><span class="line">    [_btn setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];</span><br><span class="line">    _btn.titleEdgeInsets = UIEdgeInsetsMake(5, 20, 5, 20);</span><br><span class="line">    _btn.frame = CGRectMake(self.view.frame.size.width/2-70, 300, 140, 50);</span><br><span class="line">    [_btn addTarget:self action:@selector(onClick) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">    [self.view addSubview:_btn];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)onClick &#123;</span><br><span class="line">    NSThread *currentThread = [NSThread currentThread];</span><br><span class="line">    NSLog(@&quot;btnclick--%@--current&quot;,currentThread);</span><br><span class="line">    NSThread *mainThread = [NSThread mainThread];</span><br><span class="line">    NSLog(@&quot;btnclick--%@--main&quot;,mainThread);</span><br><span class="line">//    [self threadCreate1];</span><br><span class="line">//    [self threadCreate2];</span><br><span class="line">    [self threadCreate3];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)run:(NSString *)params &#123;</span><br><span class="line">    NSThread *cur = [NSThread currentThread];</span><br><span class="line">    for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">        NSLog(@&quot;%@---call run--%@&quot;,cur,params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/// 第一种初始化</span><br><span class="line">-(void)threadCreate1 &#123;</span><br><span class="line">    NSThread *threadA = [[NSThread alloc] initWithTarget:self selector:@selector(run:) object:@&quot;threadA&quot;];</span><br><span class="line">    threadA.name = @&quot;线程A&quot;;</span><br><span class="line">    /// 必须使用start启动线程</span><br><span class="line">    [threadA start];</span><br><span class="line">    NSThread *threadB = [[NSThread alloc] initWithTarget:self selector:@selector(run:) object:@&quot;threadB&quot;];</span><br><span class="line">    threadB.name = @&quot;线程B&quot;;</span><br><span class="line">    [threadB start];</span><br><span class="line">&#125;</span><br><span class="line">/// 第二种初始化</span><br><span class="line">- (void)threadCreate2 &#123;</span><br><span class="line">    [NSThread detachNewThreadSelector:@selector(run:) toTarget:self withObject:@&quot;threadCreate2&quot;];</span><br><span class="line">&#125;</span><br><span class="line">/// 第三种初始化</span><br><span class="line">- (void)threadCreate3 &#123;</span><br><span class="line">    [self performSelectorInBackground:@selector(run:) withObject:@&quot;threadCreate3&quot;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;主线程的名字是main，手动创建的线程可以重新命名。</p>
<h3 id="使用GCD实现多线程"><a href="#使用GCD实现多线程" class="headerlink" title="使用GCD实现多线程"></a>使用GCD实现多线程</h3><p>&ensp;&ensp;使用GCD可以比NSThread更快,更方便的实现多线程的处理,使用GCD需要明确两个概念,队列和任务.队列:队列是GCD中用来存放任务的集合,负责管理开发者提交的任务.队列的核心就是将长期执行的任务分成多个工作单元,并将任务添加到队列中,系统会带为管理这些队列.并放到多线程中执行.队列分为串行队列和并行队列.串行队列内部只维护一个线程,一次只能执行一个任务.任务串行执行.并行队列内部维护了多个线程,可以按照如队列顺序并行执行. 任务:任务时用户提交给队列的工作单元,也就是在队列中执行的代码块.任务提交后会由队列以多线程的方式执行.</p>
<h4 id="创建队列"><a href="#创建队列" class="headerlink" title="创建队列"></a>创建队列</h4><p>&ensp;&ensp;全局并发队列,全局并发队列可以并行的执行多个任务,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//identifier 指定队列优先级</span><br><span class="line">// flags 保留字段,方便以后扩展</span><br><span class="line">dispatch_queue_global_t dispatch_get_global_queue(intptr_t identifier, uintptr_t flags)</span><br><span class="line"></span><br><span class="line">// 实例</span><br><span class="line">dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;创建串行队列和并行队列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 创建队列</span><br><span class="line">//label 表示队列的字符串(c字符串)</span><br><span class="line">//attr 标识串行还是并行 DISPATCH_QUEUE_SERIAL 串行, DISPATCH_QUEUE_CONCURRENT 并行</span><br><span class="line">dispatch_queue_t dispatch_queue_create(const char *_Nullable label,dispatch_queue_attr_t _Nullable attr);</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;获取主队列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/// 获取主队列</span><br><span class="line">dispatch_queue_t queue = dispatch_get_main_queue();</span><br></pre></td></tr></table></figure>

<h4 id="提交任务"><a href="#提交任务" class="headerlink" title="提交任务"></a>提交任务</h4><p>&ensp;&ensp;队列创建结束之后,可以通过同步和异步两种方式向队列提交任务. 同步执行:同步执行的任务只会在当前线程执行任务,不会开启新线程.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">///同步执行</span><br><span class="line">/// queue 将要提交到的任务队列, block 执行的代码块</span><br><span class="line">dispatch_sync(dispatch_queue_t queue, DISPATCH_NOESCAPE dispatch_block_t block);</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;异步执行任务,异步执行会在新线程中执行任务具备开启新线程的能力,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">///异步执行</span><br><span class="line">///queue 将要提交到的任务队列, block 执行的代码块</span><br><span class="line">dispatch_async(dispatch_queue_t queue, dispatch_block_t block);</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;下面是一个代码实例,展示了串行队列下的同步执行和并行队列下的同步执行,串行队列下的异步执行和并行队列下的异步执行.</p>
<p>同步执行不会开启新的线程,是在主线程完成任务的,同步的并行也不会开启新线程,两个都是串行执行任务.</p>
<p><img src="/2021/10/08/iOS多线程/serialSerial.png" alt="syncSerial"></p>
<p>异步执行串行队列的任务,会开启新线程,但是任务串行执行.</p>
<p><img src="/2021/10/08/iOS多线程/concerrentSerial.png" alt="asyncSerial"></p>
<p>异步执行并行队列任务,会开启新线程,任务并行执行.</p>
<p><img src="/2021/10/08/iOS多线程/asyncConcerrent.png" alt="asyncConcerrent"></p>
<p>&ensp;&ensp;下表展示了同步执行串行队列任务和并行队列任务,异步执行串行队列任务和并行队列任务的结果</p>
<p><img src="/2021/10/08/iOS多线程/outcome.png" alt="outcome"></p>
<h4 id="单次或者重复执行任务"><a href="#单次或者重复执行任务" class="headerlink" title="单次或者重复执行任务"></a>单次或者重复执行任务</h4><p>&ensp;&ensp;如果想要某些操作只执行一次,可以使用dispatch_once()实现,干函数接收两个参数,第一个参数接收一个标识符,用来标识代码代码是否已经执行.第二个参数是只执行一次的代码块.如果想要某些操作重复执行多次,可以使用dispatch_apply();</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// iterations 需要执行的次数  queue 任务需要提交的目标队列  block 需要重复执行的代码块</span><br><span class="line">void dispatch_apply(size_t iterations,</span><br><span class="line">		dispatch_queue_t DISPATCH_APPLY_QUEUE_ARG_NULLABILITY queue,</span><br><span class="line">		DISPATCH_NOESCAPE void (^block)(size_t));</span><br></pre></td></tr></table></figure>

<h4 id="调度队列组"><a href="#调度队列组" class="headerlink" title="调度队列组"></a>调度队列组</h4><p>&ensp;&ensp;假设有如下一个一个场景,一个音乐app,需要执行多个下载任务,这些下载任务会放到后台的多个线程中执行,当全部下载任务结束之后,弹出一个提示框告知用于下载结束.<br>这种场景可以使用队列组在实现.使用dispatch_group_create()创建队列组,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/// 创建队列组</span><br><span class="line">dispatch_group_t dispatch_group_create(void);</span><br></pre></td></tr></table></figure>

<p>创建队列组后,可以使用dispatch_group_async()函数将需要执行的任务提交到队列组,会异步的执行任务组中的任务,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// 异步执行队列组中的任务 group,队列组  queue,任务需要提交到的队列, block,需要执行的代码块</span><br><span class="line">void dispatch_group_async(dispatch_group_t group,</span><br><span class="line">	dispatch_queue_t queue,</span><br><span class="line">	dispatch_block_t block);</span><br></pre></td></tr></table></figure>

<p>任务组中的任务执行完之后可以通过dispatch_group_notify()来通知,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// group, 创建的队列组 queue,将要执行的任务所添加到的队列  block,执行的代码块</span><br><span class="line">void dispatch_group_notify(dispatch_group_t group,</span><br><span class="line">	dispatch_queue_t queue,</span><br><span class="line">	dispatch_block_t block);</span><br></pre></td></tr></table></figure>

<p>这里的demo展示的是使用队列组进行图片下载,在图片下载完成后,回到主队列进行渲染和展示.但是队列组中的每一次下载都是新开了线程,并且是并行执行的.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (void)groupImage &#123;</span><br><span class="line">    __block typeof(self) weakSelf=self;</span><br><span class="line">    dispatch_group_t group = dispatch_group_create();</span><br><span class="line">    __block UIImage *img1 = nil;</span><br><span class="line">    dispatch_group_async(group, global_queque, ^&#123;</span><br><span class="line">        img1 = [weakSelf downloadImage:@&quot;http://statics.888ppt.com/Upload/photothumb/6J93jXFHs24.jpg&quot;];</span><br><span class="line">        NSLog(@&quot;--%@--&quot;,[NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">    __block UIImage *img2 = nil;</span><br><span class="line">    dispatch_group_async(group, global_queque, ^&#123;</span><br><span class="line">        img2 = [weakSelf downloadImage:@&quot;http://up.enterdesk.com/edpic/d4/32/68/d43268ae15cefc60c54b8b0f94a46c74.jpg&quot;];</span><br><span class="line">        NSLog(@&quot;--%@--&quot;,[NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">    dispatch_group_notify(group, global_queque, ^&#123;</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            weakSelf.imgView1.image = img1;</span><br><span class="line">            weakSelf.imgView2.image = img2;</span><br><span class="line">            NSLog(@&quot;--%@--&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用NSOperation实现多线程"><a href="#使用NSOperation实现多线程" class="headerlink" title="使用NSOperation实现多线程"></a>使用NSOperation实现多线程</h3><p>&ensp;&ensp;NSOperation是使用oc封装的基于gcd的多线程处理方式,更加面向对象<strong>1、执行操作</strong>,如果要执行一个NSOperation对象,可以通过1、手动调用start方法实现,这个方法调用之后,就会在当前调用的线程同步执行任务.2、可以将NSOperation添加到NSOperationQueue中,NSOperationQueue会在NSOperation被添加进去后尽快执行,并且是异步执行.<strong>2、取消操作</strong>,当一个operation开始执行后,默认会一直执行到结束,也可以调用cancel取消操作的执行,需要注意的是,如果操作在队列中没有开始执行,这时取消这个操作,并将finished设置为YES,此时操作就直接取消了.如果操作正在执行,设置cancel方法也只能等待操作执行完.<strong>3、添加依赖</strong>,可以将多个耗时的异步操作分成若干部分,当前一个执行完后在执行另一个,可以通过addDependency方法,协调先后关系.注意:两个任务间不能相互依赖,比如A依赖B,B依赖A,这样会导致思索.当每个操作结束后需要将isFinished设置为Yes.<strong>4、监听操作</strong>,使用setCompletionBlock可以在一个operation结束后做一些其他事情.</p>
<h4 id="NSOperationQueue"><a href="#NSOperationQueue" class="headerlink" title="NSOperationQueue"></a>NSOperationQueue</h4><p>&ensp;&ensp; NSOperationQueue与GCD队列一样,采用先进先出的方式,负责管理系统提交的多个NSOperation对象.NSOperationQueue负责管理其中持有的NSOperation对象,下面是一些常见的方法:<br><strong>1、添加NSOperation到NSOperationQueue中</strong>,将NSOperation添加到队列中,并由队列中的线程池管理和调度,使用如下方法来管理,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/// ops,将要添加到队列的操作组, wait 是否等待操作结束后在返回,设置为yes会阻塞主线程</span><br><span class="line">- (void)addOperations:(NSArray&lt;NSOperation *&gt; *)ops waitUntilFinished:(BOOL)wait</span><br></pre></td></tr></table></figure>

<p>也可以使用如下方法来添加任务,添加任务到队列中后不要在手动更改任务的状态,队列会自行进行管理.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/// block 将要执行的代码块</span><br><span class="line">- (void)addOperationWithBlock:(void (^)(void))block;</span><br></pre></td></tr></table></figure>

<p><strong>2、修改NSOperation对象执行顺序</strong>,对于添加到队列中的操作对象,执行顺序依赖亮点,1、操作对象是否已经是就绪态,2、操作对象的优先级高低.可以通过手动设置queuePriority在更改operation的优先级.<br><strong>3、设置操作队列的最大并发数量</strong>,当队列中线程过多时,会影响app的执行效率,因此可以设置对答并发数量来约束队列中的最大进程数<br><strong>4、等待NSOperation操作执行完成</strong>,不要在主线程使用如下方法,这回阻塞主线程.app显示为无响应.<br><strong>5、使用NSOperation子类进行操作</strong>,NSOperation是一个抽象基类,可以自行继承这个类创建自己的操作对象,也可以使用NSInvocationOperation和NSBlockOperatin来进行操作.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (void)waitUntilFinished ;</span><br><span class="line">- (void)waitUntilAllOperationsAreFinished;</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;因此,使用NSOperation和NSOperationQueue两个类结合使用可以实现多线程,1、将需要执行的操作添加到NSOperation中.2、将NSOperation添加到NSOperationQueue中.3、系统自动取出NSOperationQueue中的对象.4、取出的对象会自动创建新线程进行.</p>
<h4 id="iOS多线程小demo"><a href="#iOS多线程小demo" class="headerlink" title="iOS多线程小demo"></a>iOS多线程小demo</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t serialQueue = dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;1&quot;);</span><br><span class="line"></span><br><span class="line">dispatch_async(serialQueue, ^&#123;</span><br><span class="line">    </span><br><span class="line">     NSLog(@&quot;2&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;3&quot;);</span><br><span class="line"></span><br><span class="line">dispatch_sync(serialQueue, ^&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;4&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;5&quot;);</span><br></pre></td></tr></table></figure>

<p>&ensp;&ensp;上述代码执行结果为13245或者12345,结果是固定的.明确概念,任务是执行在队列上的,队列是运行在线程上的.一个线程上可以同时出现多个队列.同步任务会阻塞线程.异步任务不会阻塞线程.异步任务具有开启新线程的能力.如果是自定义队列,异步执行会为其开启新线程,如果是主队列,异步执行不会开启新线程,在主线程上执行.</p>
<p>&ensp;&ensp;对于上面代码,首先打印1,然后异步执行串行队列上的任务,不会阻塞当前线程(主线程),打印3,4和5的顺序是固定的,因为4是同步任务,2和4的顺序是固定的,因为两者在同一个队列上,需要按照fifo的顺序执行.因此,只需要考虑2和3谁先谁后即可,应该说都有可能,因此最后结果是13245或者12345.</p>
<p>&ensp;&ensp;上文中的demo参考<a href="https://github.com/SJ110/ios-animation-demo" target="_blank" rel="noopener">此处</a>即可.</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/09/12/iOS动画基础/" rel="next" title="iOS动画基础">
                <i class="fa fa-chevron-left"></i> iOS动画基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/10/24/动态item实现的动态化/" rel="prev" title="动态item实现的动态化">
                动态item实现的动态化 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Xiaopingpp">
            
              <p class="site-author-name" itemprop="name">Xiaopingpp</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">50</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/SJ110" title="GitHub &rarr; https://github.com/SJ110" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:songjunp@qq.com" title="E-Mail &rarr; mailto:songjunp@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://leetcode-cn.com/u/songjunp/" title="leetcode &rarr; https://leetcode-cn.com/u/songjunp/" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>leetcode</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#进程和线程"><span class="nav-number">2.</span> <span class="nav-text">进程和线程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#线程的串行和并行"><span class="nav-number">2.1.</span> <span class="nav-text">线程的串行和并行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多线程分类"><span class="nav-number">2.2.</span> <span class="nav-text">多线程分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线程的状态"><span class="nav-number">2.3.</span> <span class="nav-text">线程的状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线程间的安全隐患"><span class="nav-number">2.4.</span> <span class="nav-text">线程间的安全隐患</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线程间通信"><span class="nav-number">2.5.</span> <span class="nav-text">线程间通信</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用NSThread实现多线程"><span class="nav-number">3.</span> <span class="nav-text">使用NSThread实现多线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用GCD实现多线程"><span class="nav-number">4.</span> <span class="nav-text">使用GCD实现多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建队列"><span class="nav-number">4.1.</span> <span class="nav-text">创建队列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#提交任务"><span class="nav-number">4.2.</span> <span class="nav-text">提交任务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#单次或者重复执行任务"><span class="nav-number">4.3.</span> <span class="nav-text">单次或者重复执行任务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#调度队列组"><span class="nav-number">4.4.</span> <span class="nav-text">调度队列组</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用NSOperation实现多线程"><span class="nav-number">5.</span> <span class="nav-text">使用NSOperation实现多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NSOperationQueue"><span class="nav-number">5.1.</span> <span class="nav-text">NSOperationQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#iOS多线程小demo"><span class="nav-number">5.2.</span> <span class="nav-text">iOS多线程小demo</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiaopingpp</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">213k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">3:13</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.2.0"></script>



  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
<!-- ҳ����С���� -->
<script type="text/javascript" src="/js/clicklove.js"></script>